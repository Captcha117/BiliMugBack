<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="io.oken1.modules.game.dao.GameDetailDao">
    <select id="getPackageListByGameId" resultType="map">
        select p.game_id                           GameId,
               p.package_id                        PackageId,
               p.package_name                      PackageName,
               p.package_price                     PackagePrice,
               p.release_date                      ReleaseDate,
               p.description                       Description,
               (select count(1)
                from mug_package_detail d
                where d.package_id = p.package_id) SongCount,
               g.common_name                       CommonName,
               g.icon_version                      IconVersion
        from mug_package p
                 left join mug_game g on p.game_id = g.game_id
        where p.game_id = #{gameId}
        order by p.release_date desc
    </select>

    <select id="getVersionListByGameId" resultType="map">
        select v.version_no   VersionNo,
               v.version_info VersionInfo,
               v.version_date VersionDate
        from mug_version v
        where v.game_id = #{gameId}
        order by v.version_date desc
    </select>

    <select id="getSnsListByGameId" resultType="map">
        SELECT s.sns_type SnsType,
               s.sns_url  Url
        FROM mug_sns AS s
                 LEFT JOIN tb_sns_type AS t ON s.sns_type = t.sns_type
        WHERE s.item_type = 'G'
          AND s.item_id = #{gameId}
        ORDER BY t.inx
    </select>

    <select id="getDifficultyListByGameId" resultType="map">
        SELECT d.difficulty_id   DifficultyId,
               d.difficulty_name DifficultyName,
               d.difficulty_abbr DifficultyAbbr,
               d.color           Color
        FROM mug_difficulty d
        WHERE d.game_id = #{gameId}
        ORDER BY d.inx
    </select>
</mapper>